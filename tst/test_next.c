/**
 * @file
 *
 * Test suite of LibISAAC
 *
 * @copyright Copyright © 2020, Matjaž Guštin <dev@matjaz.it>
 * <https://matjaz.it>. All rights reserved.
 * @license BSD 3-clause license.
 */

#include "test.h"

#define EXPECTED_NEXT_ELEMENTS 512

/*
 * This is the stream of uint32 values obtained by calling isaac_next()
 * repeatedly after the isaac_ctx_t has been initialised with a zero seed.
 *
 * In particular this is the value printed by next_values_zero_seed()
 * in generate.c
 */
const static uint32_t expected_next_results[EXPECTED_NEXT_ELEMENTS] = {
        0x182600F3UL, 0x300B4A8DUL, 0x301B6622UL, 0xB08ACD21UL, 0x296FD679UL,
        0x995206E9UL, 0xB3FFA8B5UL, 0x0FC99C24UL, 0x5F071FAFUL, 0x52251DEFUL,
        0x894F41C2UL, 0xCC4C9AFBUL, 0x96C33F74UL, 0x347CB71DUL, 0xC90F8FBDUL,
        0xA658F57AUL, 0xC5C29E18UL, 0x6249FA29UL, 0xBAE16FFAUL, 0x25C871BDUL,
        0xF4C75E24UL, 0x5AB3EAB9UL, 0xAC450B8FUL, 0x1629CFA4UL, 0x0016E86FUL,
        0xF27C4D0DUL, 0x67648B17UL, 0x05C04FCEUL, 0x44D3FF79UL, 0xC6ACD20FUL,
        0x472FD994UL, 0x842131C4UL, 0xEAD4A900UL, 0xC01EDA0DUL, 0x9E604C7BUL,
        0xFB8A0E99UL, 0x02E17B6FUL, 0xE8B4F627UL, 0xC7041EAEUL, 0x42D19CD7UL,
        0xA358EB94UL, 0x19CA2158UL, 0x6BE6CE81UL, 0x4B90A4DEUL, 0x26F0774DUL,
        0x4E83930AUL, 0x2492D476UL, 0xB97FFABEUL, 0x675CC8AEUL, 0x4CFDD254UL,
        0x5D3C00EAUL, 0x7BBA5EADUL, 0x6F461810UL, 0xBEF63EEAUL, 0x72EB767BUL,
        0xED6E963BUL, 0xB026016DUL, 0x17CB7EBFUL, 0xA7DC6E56UL, 0xF460BDF1UL,
        0x1FFE0E04UL, 0x902B347DUL, 0x02C0D8ABUL, 0x98CB3F8BUL, 0x6F359A39UL,
        0x9521825FUL, 0x9026D97EUL, 0xDE342516UL, 0x890A740CUL, 0x0F2969E4UL,
        0x2E7EA9EDUL, 0x394B8A4FUL, 0x1BDF1FD0UL, 0x15D565B4UL, 0xBAF0406DUL,
        0x4DAC20DBUL, 0x03359832UL, 0xE34802D5UL, 0xCC5FFF02UL, 0x0935AD6EUL,
        0x7C53C9B2UL, 0xB10B5D29UL, 0x4FBB94BEUL, 0xD7E48546UL, 0xB7CFA23CUL,
        0x7F081C9AUL, 0xE099BAF1UL, 0x9C7DC323UL, 0xB831AD14UL, 0x5B563101UL,
        0xFA55319BUL, 0x060DED54UL, 0xC5418124UL, 0x765F0DBAUL, 0x1AD3D9D5UL,
        0x3F07EC49UL, 0xDD5E06C6UL, 0xC230E2ACUL, 0xC6BA1971UL, 0x9CC17BCCUL,
        0x10B22A22UL, 0x7DFC8C7FUL, 0xB3310333UL, 0x205530EEUL, 0xDBF38A8FUL,
        0x003A02F5UL, 0x007E96A3UL, 0x36658201UL, 0x08DFD64FUL, 0x6275ACF3UL,
        0x3D29669BUL, 0x6B2F4538UL, 0xB0CC336BUL, 0x1D3043EBUL, 0x1AD1D764UL,
        0x4C655B84UL, 0x7A725BB2UL, 0xB3FC5C66UL, 0x80B4B915UL, 0xB2CBD9E4UL,
        0x2992DFC6UL, 0xDF8BE548UL, 0xB310D06EUL, 0x436385C6UL, 0x44D6E893UL,
        0x44C4D79DUL, 0xE3BB2064UL, 0xE41EA465UL, 0x3FF4CC70UL, 0x9D21AC42UL,
        0x672C3725UL, 0xA43A1D02UL, 0xFD84B19BUL, 0x5B6FB132UL, 0x4AF40896UL,
        0xE15000A6UL, 0x7CAB12F6UL, 0x8B8E753CUL, 0xFB253454UL, 0x359AC366UL,
        0x67822B45UL, 0x290A1140UL, 0xADE6E428UL, 0x6095EFCBUL, 0x99D8D9E6UL,
        0xA5B5981DUL, 0x332C95D6UL, 0xAF5CFCABUL, 0x161F5CA6UL, 0x1844CEE2UL,
        0xFFB8AB5CUL, 0x82FCCAEBUL, 0x49ECF97AUL, 0x7A60FABDUL, 0xF9585A3AUL,
        0x4EB6BD32UL, 0x3B347002UL, 0xF4930DBAUL, 0x5D21D51EUL, 0x64E8E3F4UL,
        0x52801FA8UL, 0x71CE907CUL, 0x872783A4UL, 0x0761DC80UL, 0x5C509848UL,
        0x41BA2ADCUL, 0x7E2F5520UL, 0x85C5EEC2UL, 0x368D3D00UL, 0x5FC7C5F3UL,
        0xB849D785UL, 0xD95F25B3UL, 0x79801FD5UL, 0xBF2443D6UL, 0x360D41CDUL,
        0x651B11C0UL, 0x801A89CAUL, 0x8B9E6B94UL, 0xFDE283C4UL, 0xCC5E6974UL,
        0x2B2F4C09UL, 0x8B2160A8UL, 0xDBF57F01UL, 0x76AA1C4EUL, 0x11F0831AUL,
        0x54713D17UL, 0xC99A2639UL, 0x4C373E7AUL, 0x09E6E57FUL, 0x71F63B07UL,
        0x7BE3F02EUL, 0x2C907ADEUL, 0xE5F489F6UL, 0x0B0CD6DAUL, 0xB566E14CUL,
        0x0F955969UL, 0xA0E5710BUL, 0x80D8C2DEUL, 0x9971E496UL, 0xC7EFBC2FUL,
        0x97A48E53UL, 0x2D845C0DUL, 0xE1194B0EUL, 0xAD2BA480UL, 0xD5253552UL,
        0xCA890B31UL, 0x60060AFBUL, 0x89DAE927UL, 0x565E2229UL, 0x43ABC21CUL,
        0x03DD14A5UL, 0xBBADD184UL, 0x9E979702UL, 0x2F659883UL, 0xF313ADECUL,
        0x621BD7CAUL, 0xB6470834UL, 0x4C3901C6UL, 0x32028BB8UL, 0x9DED8244UL,
        0x66907654UL, 0x0A06B272UL, 0x4A8EC630UL, 0x4207D36FUL, 0x3E7A8B49UL,
        0x13871BE7UL, 0xBF7AF48EUL, 0x3DE0DF39UL, 0x0E864542UL, 0x8C090A23UL,
        0xAF90E49EUL, 0x97661C5EUL, 0x365AA66CUL, 0x0073E342UL, 0x9C8AC447UL,
        0x6F57E7CEUL, 0xD5BE7FFAUL, 0x89651D84UL, 0x53F78EAAUL, 0x8173DC04UL,
        0xD70B1E10UL, 0x43C1A57BUL, 0x10C8A5ABUL, 0xED6ABD62UL, 0x2F840E43UL,
        0x4873D91EUL, 0x49F413FCUL, 0x5D89A1C1UL, 0xD3A388FCUL, 0x96C59CF4UL,
        0x456F1EDDUL, 0x3DD20023UL, 0xA264E933UL, 0xD32956E5UL, 0xD91AA738UL,
        0xE76DD339UL, 0x7A68710FUL, 0x6554ABDAUL, 0x90C10757UL, 0x0B5E435FUL,
        0xAF7D1FB8UL, 0x01913FD3UL, 0x6A158D10UL, 0xB8F6FD4AUL, 0xC2B9AA36UL,
        0x96DA2655UL, 0xFE1E42D5UL, 0x56E6CD21UL, 0xD5B2D750UL, 0x7229EA81UL,
        0x5DE87ABBUL, 0xB6B9D766UL, 0x1E16614CUL, 0x3B708F99UL, 0x5CF824CDUL,
        0xA4CA0CF1UL, 0x62D31911UL, 0x7CDD662FUL, 0xCB9E1563UL, 0x79AE4C10UL,
        0x080C79ECUL, 0x18080C8EUL, 0x4A0A283CUL, 0x3DDE9F39UL, 0x09C36F90UL,
        0xAD567643UL, 0x08294766UL, 0xB4415F7DUL, 0x5597EC0FUL, 0x78FFA568UL,
        0x8BACE62EUL, 0x4188BFCDUL, 0xC87C8006UL, 0xAFA92A6DUL, 0x50FC8194UL,
        0xCAE8DEBAUL, 0x33F6D7B1UL, 0x53245B79UL, 0x61119A5AUL, 0x7E315AEBUL,
        0xE75B41C9UL, 0xD2A93B51UL, 0xEC46B0B6UL, 0x1ED3FF4EUL, 0x5D023E65UL,
        0xADF6BC23UL, 0xF7F58F7BUL, 0xE4F3A26AUL, 0x0C571A7DUL, 0xED35E5EEUL,
        0xEADEBEACUL, 0x30BCC764UL, 0x66F1E0ABUL, 0x826DFA89UL, 0x0D9C7E7EUL,
        0xE7E26581UL, 0xD5990DFBUL, 0x02C9B944UL, 0x4112D96CUL, 0x3FF1E524UL,
        0xC35E4580UL, 0xFDFEF62DUL, 0xB83F957AUL, 0xBFC7F7CCUL, 0xB510CE0EUL,
        0xCD7411A7UL, 0x04DB4E13UL, 0x76904B6DUL, 0x08607F04UL, 0x3718D597UL,
        0x46C0A6F5UL, 0x8406B137UL, 0x309BFB78UL, 0xF7D3F39FUL, 0x8C2F0D55UL,
        0xC613F157UL, 0x127DD430UL, 0x72C9137DUL, 0x68A39358UL, 0x07C28CD1UL,
        0x848F520AUL, 0xDD2DC1D5UL, 0x9388B13BUL, 0x28E7CB78UL, 0x03FB88F4UL,
        0xB0B84E7BUL, 0x14C8009BUL, 0x884D6825UL, 0x21C171ECUL, 0x0809E494UL,
        0x6A107589UL, 0x12595A19UL, 0x0BB3263FUL, 0x4D8FAE82UL, 0x2A98121AUL,
        0xB00960BAUL, 0x6708A2BCUL, 0x35A124B5UL, 0xBCCAAEEDUL, 0x294D37E5UL,
        0xD405DED8UL, 0x9F39E2D9UL, 0x21835C4DUL, 0xE89B1A3BUL, 0x7364944BUL,
        0xBD2E5024UL, 0x6A123F57UL, 0x34105A8CUL, 0x5AD0D3B0UL, 0xCC033CE3UL,
        0xD51F093DUL, 0x56A001E3UL, 0x01A9BD70UL, 0x8891B3DBUL, 0x13ADD922UL,
        0x3D77D9A2UL, 0x0E7E0E67UL, 0xD73F72D4UL, 0x917BDEC2UL, 0xA37F63FFUL,
        0x23D74F4EUL, 0x3A6CE389UL, 0x0606CF9FUL, 0xDE11ED34UL, 0x70CC94AEUL,
        0xCB0EEE4AUL, 0x13EDC0CBUL, 0xFE29661CUL, 0xDB6DBE96UL, 0xB388D96CUL,
        0x33BC405DUL, 0xA6D12101UL, 0x2F36FA86UL, 0x7DED386FUL, 0xE6344451UL,
        0xCD57C7F7UL, 0x1B0DCDC1UL, 0xCD49EBDBUL, 0x9E8A51DAUL, 0x12A0594BUL,
        0x60D4D5F8UL, 0x91C8D925UL, 0xE43D0FBBUL, 0x5D2A542FUL, 0x451E7EC8UL,
        0x2B36505CUL, 0x37C0ED05UL, 0x2364A1AAUL, 0x814BC24CUL, 0xE3A662D9UL,
        0xF2B5CC05UL, 0xB8B0CCFCUL, 0xB058BAFBUL, 0x3AEA3DECUL, 0x0D028684UL,
        0x64AF0FEFUL, 0x210F3925UL, 0xB67EC13AUL, 0x97166D14UL, 0xF7E1CDD0UL,
        0x5ADB60E7UL, 0xD5295EBCUL, 0x28833522UL, 0x60EDA8DAUL, 0x7BC76811UL,
        0xAC9FE69DUL, 0x30AB93ECUL, 0x03696614UL, 0x15E3A5B9UL, 0xECC5DC91UL,
        0x1D3B8E97UL, 0x7275E277UL, 0x538E1F4EUL, 0x6CB167DBUL, 0xA7A2F402UL,
        0x2DB35DFEUL, 0xA8BCC22DUL, 0xD8C58A6AUL, 0x6A529B0BUL, 0x0FD43963UL,
        0xAFC17A97UL, 0x943C3C74UL, 0x95138769UL, 0x6F4E0772UL, 0xB143B688UL,
        0x3B18E752UL, 0x69D2E4AEUL, 0x8107C9FFUL, 0xCDBC62E2UL, 0x5781414FUL,
        0x8B87437EUL, 0xA70E1101UL, 0x91DABC65UL, 0x4E232CD0UL, 0x229749B5UL,
        0xD7386806UL, 0xB3C3F24BUL, 0x60DC5207UL, 0x0BDB9C30UL, 0x1A70E7E9UL,
        0xF37C71D5UL, 0x44B89B08UL, 0xB4D2F976UL, 0xB40E27BCUL, 0xFFDF8A80UL,
        0x9C411A2AUL, 0xD0F7B37DUL, 0xEF53CEC4UL, 0xECA4D58AUL, 0x0B923200UL,
        0xCF22E064UL, 0x8EBFA303UL, 0xF7CF814CUL, 0x32AE2A2BUL, 0xB5E13DAEUL,
        0xC998F9FFUL, 0x349947B0UL, 0x29CF72CEUL, 0x17E38F85UL, 0xF3B26129UL,
        0xD45D6D81UL, 0x09B3CE98UL, 0x860536B8UL, 0xE5792E1BUL, 0x12AD6419UL,
        0xF5F71C69UL, 0xCBC8B7C2UL, 0x8F651659UL, 0xA0CC74F3UL, 0xD78CB99EUL,
        0x51C08D83UL, 0x29F55449UL, 0x002ED713UL, 0x38A824F3UL, 0x57161DF6UL,
        0x7452E319UL, 0x25890E2EUL, 0xC7442433UL, 0x4A5F6355UL, 0x6A83E1E0UL,
        0x823CEDB6UL, 0xF1D444EBUL, 0x88381097UL, 0x5DE3743EUL, 0x46CA4F9AUL,
        0xD8370487UL, 0xEDEC154AUL, 0x433F1AFBUL, 0xF5FAD54FUL, 0x98DB2FB4UL,
        0xE448E96DUL, 0xF650E4C8UL,
};

/*
 * This is the stream of uint32 values obtained by calling isaac_next()
 * repeatedly after the isaac_ctx_t has been initialised with a
 * seed of {1, 2, 3, 4, 5, 6, 7, 8} (in bytes, not uint32_t)
 *
 * In particular this is the value printed by next_values_nonzero_seed()
 * in generate.c
 */
const static uint32_t expected_next32_with_nonzero_seed[EXPECTED_NEXT_ELEMENTS] = {
        0xC987111FUL, 0x33949FA5UL, 0x72F289B6UL, 0x00861702UL, 0xCB5D7A6EUL,
        0x5291E936UL, 0x79879ADEUL, 0xBB6EF9CFUL, 0x8F8DD09DUL, 0xA44B1A6CUL,
        0xB3C78167UL, 0x9020783BUL, 0xD96F29CAUL, 0x3A6AFE88UL, 0xD5EB7091UL,
        0xB61ECEB4UL, 0x2F3EA2B7UL, 0x1B42FAF8UL, 0xC3206714UL, 0xDE2CC0F2UL,
        0x6D6CF2F5UL, 0xC21F5ABBUL, 0x801851E3UL, 0xE8AD45B3UL, 0x07109ADCUL,
        0x4102234AUL, 0x9A190E08UL, 0x18A72F1CUL, 0xB0E2B8DAUL, 0x3C95A998UL,
        0x95BACD29UL, 0x5812E873UL, 0x02198D64UL, 0x4AAD18F4UL, 0x7CE73151UL,
        0x72C34521UL, 0x14CB27E6UL, 0x5244AEDCUL, 0xEF3CAE74UL, 0xE7B3824AUL,
        0x2F9D6B9EUL, 0x7D8A44C3UL, 0xD1201B3FUL, 0x25CBD94EUL, 0xC7E826DCUL,
        0x3346749DUL, 0x856509D1UL, 0x57DA3982UL, 0xFA26FD63UL, 0x1C672264UL,
        0xC10A02AAUL, 0x67B1E46EUL, 0x285AAAD7UL, 0x8093DC57UL, 0x9F00DBC5UL,
        0xA191268DUL, 0x23F5BE25UL, 0xC84CB5C8UL, 0x6E27FDD7UL, 0xE5462908UL,
        0x8BA5889AUL, 0xBDA4DE39UL, 0x84F2C60AUL, 0x11A4F036UL, 0x89BFAF02UL,
        0x4D0B3FA9UL, 0xA1166856UL, 0xD61DCCABUL, 0x61C5F7CBUL, 0x2DDEE8FCUL,
        0xD2854C55UL, 0xC4196AC9UL, 0x0A92D424UL, 0xBFA77683UL, 0x6437FFC9UL,
        0x7E4264E4UL, 0x30CA3DF0UL, 0xF9A01C7AUL, 0xFA8CFCFAUL, 0xC5241BFEUL,
        0xFA00E8BDUL, 0x7E522085UL, 0x63553457UL, 0x045D82B8UL, 0x27CDC1ABUL,
        0x871DF567UL, 0xF30AF872UL, 0x95B5B19DUL, 0xF3E36970UL, 0x94464CFFUL,
        0x32CCC4EDUL, 0xF76E828AUL, 0xE0F1700AUL, 0xB346BC60UL, 0x5CFD2F14UL,
        0xC2632062UL, 0x616ADBAEUL, 0xE73F18E9UL, 0x941F5843UL, 0x2A5CA2C8UL,
        0xDEB519ACUL, 0x19606B42UL, 0x28F80B82UL, 0xE19EBB47UL, 0xB31AA32FUL,
        0x94A3ACB2UL, 0x4DE2B784UL, 0x3EF326EAUL, 0x134CDD3BUL, 0xD739A2CDUL,
        0x97D51E1DUL, 0x594F975FUL, 0xF48CAC1AUL, 0x5F2EDC8FUL, 0x225DFDD4UL,
        0xA57E36A8UL, 0xFA32CF4DUL, 0xA58BF76DUL, 0x6D55628AUL, 0x923A1AEFUL,
        0xE0011522UL, 0x30FFAFF5UL, 0x001986ECUL, 0xEB16E097UL, 0xC403FC60UL,
        0x510566B6UL, 0x72FAB07CUL, 0x804457ACUL, 0x58A8506FUL, 0xE770B14EUL,
        0x2D83C753UL, 0x53BDD8B5UL, 0x54138AB6UL, 0x1638F87AUL, 0x1A2A834CUL,
        0x2A9F0BF4UL, 0x69E13398UL, 0x65296112UL, 0x7486F9B3UL, 0x91F0E9A1UL,
        0xF3D7C990UL, 0x754FF4ADUL, 0xBE47CE95UL, 0x409329D9UL, 0x334D3867UL,
        0x1E18D2F4UL, 0x462A0B83UL, 0x96C5A1B6UL, 0x577EBA9CUL, 0x1D2B0B09UL,
        0x681DDAB0UL, 0xC6C78665UL, 0x0179A71CUL, 0x4614AB27UL, 0x75C83725UL,
        0x35ED5CB5UL, 0xF2811F31UL, 0xECE7839FUL, 0x969F7D8EUL, 0xF92AE295UL,
        0xC6B413C5UL, 0x78E126ABUL, 0xB8227AF3UL, 0xF6BBF1EBUL, 0x22586EE0UL,
        0x4003DB22UL, 0xBC1DB747UL, 0xA0016F76UL, 0x3455F76DUL, 0xE3B9F85EUL,
        0xBD6DC736UL, 0xD7ECD061UL, 0x374094EFUL, 0x75B9074EUL, 0x73BC5ED7UL,
        0x995049CAUL, 0x0AC8FD47UL, 0xEF557607UL, 0xD19632B3UL, 0x609649B4UL,
        0xBF11FAEDUL, 0xD6F93CC5UL, 0x98BDDBEBUL, 0x9226F4D5UL, 0xC71E5F66UL,
        0x03A87846UL, 0x17366CADUL, 0x9EC3CD34UL, 0xC8C117D3UL, 0x2AC1D182UL,
        0xC188454CUL, 0x5AFB09C2UL, 0xF4375831UL, 0xB1D4FF64UL, 0x14EA480AUL,
        0xED891E9AUL, 0xB0F7D772UL, 0x92D09662UL, 0x4C0206F9UL, 0xFBCA7BD3UL,
        0xDEA0CFB2UL, 0xBDE4D3CCUL, 0x2E248D9EUL, 0xEC597682UL, 0x74E3B0DAUL,
        0x8FE9004FUL, 0x611B883EUL, 0x3515F508UL, 0x25A000CAUL, 0x7ACB9D11UL,
        0x880B875DUL, 0x2E132954UL, 0xD9BCC32CUL, 0x50F782DEUL, 0xE6ECDFA4UL,
        0xD2B774A4UL, 0x1D4FC93EUL, 0xA43329D1UL, 0x039E24C3UL, 0x0C0F343DUL,
        0x37C742F9UL, 0xA68F6920UL, 0xD913640CUL, 0xC130B1AFUL, 0x403F5CB5UL,
        0xF4AD9AC9UL, 0x7FB1B5A1UL, 0xB9717A59UL, 0x394F7918UL, 0x647E8AD8UL,
        0x22662D97UL, 0x700AE372UL, 0x4203B72EUL, 0x6DE606E2UL, 0xE1DB8AFCUL,
        0xB3F23FE7UL, 0xA22B58EDUL, 0x61B69E36UL, 0xBF2D4B76UL, 0xDD85BE5CUL,
        0x11304761UL, 0x0E121E85UL, 0xBC506172UL, 0x82605046UL, 0xA7DD8E74UL,
        0x7CE5A040UL, 0x8331A767UL, 0xE2266B16UL, 0x5E59F68AUL, 0x5E1CB8A2UL,
        0x40117235UL, 0xF795B85DUL, 0x42183AB9UL, 0x0790D1E5UL, 0xC1FF8E2CUL,
        0x971CD9C6UL, 0xBA9734AAUL, 0xAE5F7197UL, 0xEAB168BFUL, 0xAC290E78UL,
        0x44F712A6UL, 0x60D40A4BUL, 0xB2B86D44UL, 0x50CFF015UL, 0x4823F1D5UL,
        0xC332D13AUL, 0x0F00F80FUL, 0x6541C275UL, 0x78F2085BUL, 0x92FBAF98UL,
        0x4A6BCF1EUL, 0x3497D087UL, 0x9944B1F2UL, 0x0840DE1BUL, 0x20638EAEUL,
        0x6F530DD2UL, 0x4767A37CUL, 0x8ACDEC6FUL, 0x29E305B7UL, 0x26A04156UL,
        0x00E4C02CUL, 0xAA672809UL, 0x40D58097UL, 0x5F532BFAUL, 0xF71CEE7CUL,
        0xA95696BEUL, 0xCEAFA260UL, 0xAF65A0D1UL, 0x81322EC2UL, 0xCFE77E16UL,
        0xAD57C024UL, 0x77E31ACAUL, 0x6E8C4AB1UL, 0x6A000C48UL, 0xF8F026FCUL,
        0xB4148DAFUL, 0x4B12DBD3UL, 0xBD208EF8UL, 0xABDDC53AUL, 0x41320656UL,
        0xF29BAD80UL, 0xF701A783UL, 0x9F970355UL, 0xC6878C36UL, 0x8A6B25E5UL,
        0x63F39C5EUL, 0x0FB067B6UL, 0x8187E50AUL, 0xF997E711UL, 0x14CC84D3UL,
        0x8A16EFE7UL, 0x97FA0BB1UL, 0xF5872C93UL, 0xD67B28D9UL, 0xA0511087UL,
        0xFC82795BUL, 0x4C95E4AAUL, 0xE2EFE242UL, 0x9895B7BCUL, 0x2C4F6D69UL,
        0x5D762413UL, 0xD284FFA5UL, 0xE1210AE0UL, 0x08EDBAF9UL, 0x76E76F43UL,
        0x80FB6287UL, 0x8711ED8EUL, 0x849B3882UL, 0xE7B98423UL, 0xBD3FE74CUL,
        0x4392AA3BUL, 0xD88854D9UL, 0x9BB42193UL, 0x9B212735UL, 0x12FD3D1FUL,
        0xE5399B4FUL, 0xC3E392B2UL, 0x52E8A282UL, 0xD255AC25UL, 0xBD2782AEUL,
        0x3F283E49UL, 0xFD25E81AUL, 0xFFD3F4A0UL, 0x48622CFAUL, 0xB0FBEE60UL,
        0x6B555300UL, 0x279525D5UL, 0x8BC4C146UL, 0xC94CDB6DUL, 0x443DC33AUL,
        0x8F47BD4CUL, 0x97E40C3EUL, 0xFE8C0C3CUL, 0x49240BB2UL, 0xF39AAB73UL,
        0xD050DBF9UL, 0x3E8D41E1UL, 0x8D980943UL, 0xFC31FD17UL, 0x604082AAUL,
        0xBBE37F04UL, 0x0615C2D3UL, 0x31B7B137UL, 0xBEE43720UL, 0xD4EA5B72UL,
        0x91413A8FUL, 0x3ADAAE59UL, 0x2577FE7EUL, 0xFD488664UL, 0x92F1EE09UL,
        0xE7E79BD5UL, 0xC49EB8ABUL, 0x5A88F979UL, 0x2A972D99UL, 0x4DCC212AUL,
        0x21E77EF8UL, 0xE647C5DCUL, 0x69753C6CUL, 0x28FA5EFBUL, 0x662BFF5FUL,
        0x594CB517UL, 0xEBD9652BUL, 0xD742ECF1UL, 0x3961D895UL, 0x052C9414UL,
        0xD8308354UL, 0x6F348D54UL, 0x4BB16D47UL, 0xEFA5966AUL, 0xA13C3FA4UL,
        0x908E9A01UL, 0x1B1094C3UL, 0x36E57C4FUL, 0x0972EF22UL, 0x3B847C74UL,
        0xF8D1CAC0UL, 0xD245604CUL, 0xEBF27EB2UL, 0x6F59E622UL, 0x08022691UL,
        0xD9476B67UL, 0xD1A68C66UL, 0x264C453AUL, 0xFF0B1A4AUL, 0x9CC93145UL,
        0xB9DF3ACBUL, 0x6B6D6D04UL, 0xA9EA3A92UL, 0xBB625CD8UL, 0x422F887AUL,
        0x9231139BUL, 0xA566A405UL, 0x5C9AABD3UL, 0xF5860C7DUL, 0x85807D4DUL,
        0x9BB32AD9UL, 0x5E634B34UL, 0xFA87AC98UL, 0x75D83341UL, 0x4B4BE607UL,
        0xFC5FADD3UL, 0x2B3070F4UL, 0x23F23218UL, 0x601F9DB9UL, 0x2784940AUL,
        0xF99E6B58UL, 0xE9DD16C7UL, 0xDA3D4D05UL, 0x28752620UL, 0x156F46A0UL,
        0xF2C5FDE9UL, 0x91D48724UL, 0xA72EFF7DUL, 0xF90248EEUL, 0xBE7441B1UL,
        0xBAAFE2EFUL, 0x53AD384CUL, 0xF5D21F72UL, 0x36396351UL, 0xC3A347C8UL,
        0x0B6F59A1UL, 0x45889AD9UL, 0x7DE08BF8UL, 0xAFA9D792UL, 0xA92F42BAUL,
        0xFB3826FAUL, 0xACDFEE35UL, 0xA07311DBUL, 0x5F35A4DEUL, 0x21203064UL,
        0x6939C35AUL, 0xF81ED55AUL, 0x9438873AUL, 0x0B59F77AUL, 0x6C949316UL,
        0x8079CEA9UL, 0x8C6EF6ADUL, 0x547514EFUL, 0x36FFC3F5UL, 0x3051D1FEUL,
        0xCB1ECC07UL, 0xFEEEDC69UL, 0xE7D5D98CUL, 0x9AB41450UL, 0x455285F7UL,
        0x23397700UL, 0xF066DC78UL, 0xAB484604UL, 0x36C0A277UL, 0xF1F17714UL,
        0x493B98B3UL, 0xE3B24E47UL, 0xD5DC4EFDUL, 0x86D972DEUL, 0x3BC8BD09UL,
        0x04AB93D2UL, 0xF50B3B4BUL, 0x0EDAEEDBUL, 0x639721D5UL, 0xE0024ADAUL,
        0x49D24EAAUL, 0x4BC4CE39UL, 0xD08C9F5CUL, 0x24A9E662UL, 0x49B0A56FUL,
        0x904601D8UL, 0xB7900FEBUL, 0x22C18C51UL, 0x8A5A00F8UL, 0xF833B05FUL,
        0x5D20530CUL, 0x24AECD14UL, 0xBDEC3FF8UL, 0x14F8A820UL, 0x7F635121UL,
        0x6C834AA3UL, 0x539ED0FFUL, 0xE991D664UL, 0x453A9E69UL, 0x664BE282UL,
        0x14EF5FB2UL, 0x7E8B6881UL, 0xA033BF4AUL, 0x6D579D32UL, 0x0778DAB4UL,
        0xC3C1EA27UL, 0x0B8EE3E3UL, 0x4348FEA0UL, 0x5FFDEB1FUL, 0x49BC902EUL,
        0xDA3A4B2EUL, 0x37A3C216UL,
};

static void test_next32_a_few(void)
{
    isaac_ctx_t ctx;
    isaac_init(&ctx, NULL, 0);  // Zero seed
    uint32_t next;

    next = isaac_next32(&ctx);
    atto_eq(next, expected_next_results[0]);

    next = isaac_next32(&ctx);
    atto_eq(next, expected_next_results[1]);

    next = isaac_next32(&ctx);
    atto_eq(next, expected_next_results[2]);
}

static void test_next32_all(void)
{
    uint32_t result;
    isaac_ctx_t ctx;
    isaac_init(&ctx, NULL, 0);  // Zero seed
    for (uint_fast32_t i = 0; i < EXPECTED_NEXT_ELEMENTS; i++)
    {
        result = isaac_next32(&ctx);
        atto_eq(result, expected_next_results[i]);
    }
}

static void test_next8_a_few(void)
{
    isaac_ctx_t ctx;
    isaac_init(&ctx, NULL, 0);  // Zero seed
    uint8_t next;

    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next_results[0] >> 0U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next_results[0] >> 8U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next_results[0] >> 16U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next_results[0] >> 24U) & 0xFFU);

    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next_results[1] >> 0U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next_results[1] >> 8U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next_results[1] >> 16U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next_results[1] >> 24U) & 0xFFU);

    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next_results[2] >> 0U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next_results[2] >> 8U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next_results[2] >> 16U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next_results[2] >> 24U) & 0xFFU);
}

static void test_next8_all(void)
{
    uint8_t result;
    isaac_ctx_t ctx;
    isaac_init(&ctx, NULL, 0);  // Zero seed
    for (uint_fast32_t i = 0; i < EXPECTED_NEXT_ELEMENTS; i++)
    {
        for (uint_fast8_t byte = 0; byte < 4; byte++)
        {
            result = isaac_next8(&ctx);
            atto_eq(result, (expected_next_results[i] >> byte * 8U) & 0xFFU);
        }
    }
}

static void test_next32_a_few_with_nonzero_seed(void)
{
    isaac_ctx_t ctx;
    const uint8_t seed[8] = {1, 2, 3, 4, 5, 6, 7, 8};
    isaac_init(&ctx, seed, 8);
    uint32_t next;

    next = isaac_next32(&ctx);
    atto_eq(next, expected_next32_with_nonzero_seed[0]);

    next = isaac_next32(&ctx);
    atto_eq(next, expected_next32_with_nonzero_seed[1]);

    next = isaac_next32(&ctx);
    atto_eq(next, expected_next32_with_nonzero_seed[2]);
}

static void test_next32_all_with_nonzero_seed(void)
{
    uint32_t result;
    isaac_ctx_t ctx;
    const uint8_t seed[8] = {1, 2, 3, 4, 5, 6, 7, 8};
    isaac_init(&ctx, seed, 8);
    for (uint_fast32_t i = 0; i < EXPECTED_NEXT_ELEMENTS; i++)
    {
        result = isaac_next32(&ctx);
        atto_eq(result, expected_next32_with_nonzero_seed[i]);
    }
}

static void test_next8_a_few_with_nonzero_seed(void)
{
    isaac_ctx_t ctx;
    const uint8_t seed[8] = {1, 2, 3, 4, 5, 6, 7, 8};
    isaac_init(&ctx, seed, 8);
    uint8_t next;

    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next32_with_nonzero_seed[0] >> 0U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next32_with_nonzero_seed[0] >> 8U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next32_with_nonzero_seed[0] >> 16U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next32_with_nonzero_seed[0] >> 24U) & 0xFFU);

    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next32_with_nonzero_seed[1] >> 0U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next32_with_nonzero_seed[1] >> 8U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next32_with_nonzero_seed[1] >> 16U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next32_with_nonzero_seed[1] >> 24U) & 0xFFU);

    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next32_with_nonzero_seed[2] >> 0U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next32_with_nonzero_seed[2] >> 8U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next32_with_nonzero_seed[2] >> 16U) & 0xFFU);
    next = isaac_next8(&ctx);
    atto_eq(next, (expected_next32_with_nonzero_seed[2] >> 24U) & 0xFFU);
}

static void test_next8_all_with_nonzero_seed(void)
{
    uint8_t result;
    isaac_ctx_t ctx;
    const uint8_t seed[8] = {1, 2, 3, 4, 5, 6, 7, 8};
    isaac_init(&ctx, seed, 8);
    for (uint_fast16_t i = 0; i < EXPECTED_NEXT_ELEMENTS; i++)
    {
        for (uint_fast8_t byte = 0; byte < 4; byte++)
        {
            result = isaac_next8(&ctx);
            atto_eq(result,
                    (expected_next32_with_nonzero_seed[i] >> byte * 8U) &
                    0xFFU);
        }
    }
}

void test_isaac_next(void)
{
    test_next32_a_few();
    test_next32_all();
    test_next8_a_few();
    test_next8_all();
    test_next32_a_few_with_nonzero_seed();
    test_next32_all_with_nonzero_seed();
    test_next8_a_few_with_nonzero_seed();
    test_next8_all_with_nonzero_seed();
}
